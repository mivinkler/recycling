{% extends 'base.html' %}

{% load static %}
{% load sort_tags %}
{% load custom_filters %}
{% load pagination %}

{% block title %}Lieferanten{% endblock %}

{% block content %}

<div class="grid-table" data-type="supplier-list">
  <div class="grid-header">{% sort_header "id" "ID" %}</div>
  <div class="grid-header">{% sort_header "avv_number" "AVV" %}</div>
  <div class="grid-header">{% sort_header "name" "Lieferant" %}</div>
  <div class="grid-header">{% sort_header "street" "StraÃŸe" %}</div>
  <div class="grid-header">{% sort_header "postal_code" "PLZ" %}</div>
  <div class="grid-header">{% sort_header "city" "Stadt" %}</div>
  <div class="grid-header">{% sort_header "phone" "Telefon"  %}</div>
  <div class="grid-header">{% sort_header "email" "Email" %}</div>
  <div class="grid-header">{% sort_header "created_at" "Datum" %}</div>
  <div class="grid-header">{% sort_header "note" "Anmerkung" %}</div>
  
  {% for supplier in page_obj %}
  <div class="grid-row js-select-row"
    data-id="{{ supplier.id }}"
    data-url-detail="{% url 'supplier_detail' pk=supplier.id %}"
    data-url-update="{% url 'supplier_update' pk=supplier.id %}">
    
    <div>{{ supplier.id }}</div>
    <div>{{ supplier.avv_number }}</div>
    <div>{{ supplier.name }}</div>
    <div>{{ supplier.street }}</div>
    <div>{{ supplier.postal_code }}</div>
    <div>{{ supplier.city }}</div>
    <div>{{ supplier.phone }}</div>
    <div>{{ supplier.email }}</div>
    <div>{{ supplier.created_at|date:"d.m.Y" }}</div>
    <div title="{{ supplier.note }}">{{ supplier.note }}</div>
  </div>
  {% endfor %}
</div>

{% paginate page_obj %}

{% endblock %}

{% block extra_js %}
  <script src="{% static 'js/selectable-row.js' %}"></script>
  <script src="{% static 'js/current-date.js' %}"></script>
  <script>
    document.addEventListener("click", function (event) {
      document.querySelectorAll("details.top-icon-detail[open]").forEach(details => {
        if (!details.contains(event.target)) {
          details.removeAttribute("open");
        }
      });
    });
  </script>
{% endblock %}