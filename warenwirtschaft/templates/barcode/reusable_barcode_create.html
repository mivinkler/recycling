{% extends 'base.html' %}
{% load static %}

{% block title %}Barcode erstellen{% endblock %}

{% block content %}
<form method="post">
  {% csrf_token %}

  <div class="itemcard-small">
    <h2>Barcode generieren</h2>

    <section class="itemcard-topbox">
      {{ form.non_field_errors }}

      <!-- Bereich -->
      <div class="itemcard-row">
        <div>Bereich wählen:</div>
        <div>{{ form.area }}</div>
      </div>


      <!-- Eingang -->
      <div id="fields-delivery" style="display: none;">
        <div class="itemcard-row">
          <div>Kunde:</div>
          <div>{{ form.supplier }}</div>
        </div>
        <div class="itemcard-row">
          <div>Behälter-Art:</div>
          <div>
            {% with field=form.box_type %}
              <select name="{{ field.name }}">
                {% for val, label in field.field.choices %}
                  <option value="{{ val }}" {% if field.value == val %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>
            {% endwith %}
          </div>
        </div>
        <div class="itemcard-row">
          <div>Material:</div>
          <div>
            {% with field=form.material %}
              <select name="{{ field.name }}">
                {% for val, label in field.field.choices %}
                  <option value="{{ val }}" {% if field.value == val %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>
            {% endwith %}
          </div>
        </div>
        <div class="button-wrapper">
          <button type="submit" name="save" class="btn">Speichern</button>
        </div>
      </div>

      <!-- unload -->
      <div id="fields-unload" style="display: none;">
        <div class="itemcard-row">
          <div>Behälter-Art:</div>
          <div>
            {% with field=form.box_type %}
              <select name="{{ field.name }}">
                {% for val, label in field.field.choices %}
                  <option value="{{ val }}" {% if field.value == val %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>
            {% endwith %}
          </div>
        </div>
        <div class="itemcard-row">
          <div>Material:</div>
          <div>
            {% with field=form.material %}
              <select name="{{ field.name }}">
                {% for val, label in field.field.choices %}
                  <option value="{{ val }}" {% if field.value == val %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>
            {% endwith %}
          </div>
        </div>
        <div class="itemcard-row">
          <div>Weitergabe:</div>
          <div>
            {% with field=form.target %}
              <select name="{{ field.name }}">
                {% for val, label in field.field.choices %}
                  <option value="{{ val }}" {% if field.value == val %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>
            {% endwith %}
          </div>
        </div>
        <div class="button-wrapper">
          <button type="submit" name="save" class="btn">Speichern</button>
        </div>
      </div>

      <!-- recycling -->
      <div id="fields-recycling" style="display: none;">
        <div class="itemcard-row">
          <div>Behälter-Art:</div>
          <div>
            {% with field=form.box_type %}
              <select name="{{ field.name }}">
                {% for val, label in field.field.choices %}
                  <option value="{{ val }}" {% if field.value == val %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>
            {% endwith %}
          </div>
        </div>
        <div class="itemcard-row">
          <div>Material:</div>
          <div>
            {% with field=form.material %}
              <select name="{{ field.name }}">
                {% for val, label in field.field.choices %}
                  <option value="{{ val }}" {% if field.value == val %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>
            {% endwith %}
          </div>
        </div>
        <div class="button-wrapper">
          <button type="submit" name="save" class="btn">Speichern</button>
        </div>
      </div>

      <!-- Abholung -->
      <div id="fields-shipping" style="display: none;">
        <div class="itemcard-row">
          <div>Abholer:</div>
          <div>{{ form.customer }}</div>
        </div>
        <div class="itemcard-row">
          <div>Behälter-Art:</div>
          <div>
            {% with field=form.box_type %}
              <select name="{{ field.name }}">
                {% for val, label in field.field.choices %}
                  <option value="{{ val }}" {% if field.value == val %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>
            {% endwith %}
          </div>
        </div>
        <div class="itemcard-row">
          <div>Material:</div>
          <div>
            {% with field=form.material %}
              <select name="{{ field.name }}">
                {% for val, label in field.field.choices %}
                  <option value="{{ val }}" {% if field.value == val %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>
            {% endwith %}
          </div>
        </div>
        <div class="itemcard-row">
          <div>Gewicht:</div>
          <div>
            {% with field=form.weight %}
              <input type="number" step="0.01" name="{{ field.name }}" value="{{ field.value|default_if_none:'' }}">
            {% endwith %}
          </div>
        </div>
        <div class="button-wrapper">
          <button type="submit" name="save" class="btn">Speichern</button>
        </div>
      </div>


      <!-- Zusatzdaten -->
      <!-- <div id="fields-other" style="display: none;">
        <div class="itemcard-row">
          <div>Behälter:</div>
          <div>
            {% with field=form.box_type %}
              <select name="{{ field.name }}">
                {% for val, label in field.field.choices %}
                  <option value="{{ val }}" {% if field.value == val %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>
            {% endwith %}
          </div>
        </div>
        <div class="itemcard-row">
          <div>Material:</div>
          <div>
            {% with field=form.material %}
              <select name="{{ field.name }}">
                {% for val, label in field.field.choices %}
                  <option value="{{ val }}" {% if field.value == val %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>
            {% endwith %}
          </div>
        </div>
        <div class="itemcard-row">
          <div>Zweck:</div>
          <div>
            {% with field=form.target %}
              <select name="{{ field.name }}">
                {% for val, label in field.field.choices %}
                  <option value="{{ val }}" {% if field.value == val %}selected{% endif %}>{{ label }}</option>
                {% endfor %}
              </select>
            {% endwith %}
          </div>
        </div>
         <div class="itemcard-row">
          <div>Gewicht:</div>
          <div>
            {% with field=form.weight %}
              <input type="number" step="0.01" name="{{ field.name }}" value="{{ field.value }}">
            {% endwith %}
          </div>
        </div>
      </div> -->
    </section>


  </div>
</form>



<script>
  document.addEventListener('DOMContentLoaded', function () {
    const bereichField = document.querySelector('select[name="area"]');

    const fieldBlocks = {
      '1': 'fields-delivery',
      '2': 'fields-unload',
      '3': 'fields-recycling',
      '4': 'fields-shipping',
      '5': 'fields-other',
    };

    function updateFields() {
      Object.values(fieldBlocks).forEach(id => {
        const el = document.getElementById(id);
        if (el) el.style.display = 'none';
      });

      const selected = fieldBlocks[bereichField.value];
      if (selected) {
        const el = document.getElementById(selected);
        if (el) el.style.display = 'block';
      }
    }

    bereichField.addEventListener('change', updateFields);
    updateFields();
  });
</script>
{% endblock %}
