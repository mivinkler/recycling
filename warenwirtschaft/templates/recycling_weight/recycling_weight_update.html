{% extends 'base.html' %}
{% load static %}

{% block title %}Tägliches wiegen{% endblock %}

{% block content %}
<div class="itemcard">
  <div class="itemcard-title">
    <h2>Tägliches wiegen</h2>
  </div>

  <table class="itemcard-table">
    {{ formset.management_form }}
    <thead class="itemcard-thead">
      <tr>
        <th class="itemcard-id">№</th>
        <th class="itemcard-material">Material</th>
        <th class="itemcard-boxtype">Behälter</th>
        <th class="itemcard-status">Status</th>
        <th class="itemcard-weight">Gewicht</th>
        <th class="itemcard-weight">Gewicht neu</th>
        <th class="itemcard-action"></th>
      </tr>
    </thead>

    <tbody class="itemcard-tbody">
      {% for item in recycling_list %}
        {% if item.id == edit_recycling.id %}
        <form method="post" action="{% url 'recycling_weight_update' pk=item.id %}">
          {% csrf_token %}
          <tr class="itemcard-table-row active-row">
            <input type="hidden" name="recycling_id_{{ item.id }}" value="{{ item.id }}">
            
            <!-- № -->
            <td class="itemcard-id">
              {{ forloop.counter }}
            </td>

            <!-- Material -->
            <td class="itemcard-material">
              <p>{{ item.material }}</p>
            </td>

            <!-- Behälter -->
            <td class="itemcard-boxtype">
              <p>{{ item.get_box_type_display }}</p>
            </td>

            <!-- Status -->
            <td class="itemcard-status">
              <select name="status" class="active-border">
                {% for key, value in status_choices %}
                <option value="{{ key }}" {% if item.status == key %}selected{% endif %}>{{ value }}</option>
                {% endfor %}
              </select>
            </td>

            <!-- Gewicht -->
            <td class="itemcard-weight">
              <p>{{ item.weight }}</p>
            </td>

            <!-- Gewicht neu -->
            <td class="itemcard-weight">
              <input class="active-border" type="number" name="new_weight" autofocus>
            </td>

            <!-- Button -->
            <td class="itemcard-action">
              <a href="{% url 'recycling_weight_list' %}" class="btn btn-lock">
                <img src="{% static 'icons/lock-open-icon.svg' %}">
              </a>
              <button type="submit" class="btn btn-main">Speichern</button>
            </td>
          </tr>
        </form>
        {% else %}
        <tr class="itemcard-table-row">
          <td class="itemcard-id">{{ forloop.counter }}</td>
          <td class="itemcard-material">
            <p>{{ item.material }}</p>
          </td>
          <td class="itemcard-boxtype">
            <p>{{ item.get_box_type_display }}</p>
          </td>
          <td class="itemcard-status">
            <p>{{ item.get_status_display }}</p>
          </td>
          <td class="itemcard-weight">
            <p>{{ item.weight }}</p>
          </td>
          <td class="itemcard-weight">
            <a href="{% url 'recycling_weight_update' item.id %}"></a>
          </td>
          <td class="itemcard-action">
            <a href="{% url 'recycling_weight_update' item.id %}" class="btn btn btn-lock">
              <img src="{% static 'icons/lock-icon.svg' %}">
            </a>
          </td>
        </tr>
        {% endif %}
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
