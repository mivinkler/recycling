{% extends 'base.html' %}

{% load custom_filters %}
{% load pagination %}
{% load sorting %}
{% load static %}

{% block title %}{{ _("Einheiten") }}{% endblock %}

{% block content %}

<div class="table-name">Entladung</div>

<div class="select_cargo">
    <table class="table-box">
        <thead>
            <caption><p>Liefereinheiten</p></caption>
            <tr class="table-content-title">
                <th style="width: 4%" class="text-center">w√§hlen</th>
                <th style="width: 3.5%" class="text-center">ID</th>
                <th style="width: 20%">Lieferant</th>
                <th style="width: 6%">Datum</th>
                <th style="width: 3.5%" class="text-center">LID</th>
                <th style="width: 10%">Beh√§lter</th>
                <th style="width: 10%">Inhalt</th>
                <th style="width: 6%">Gewicht</th>
                <th style="width: 6%">Status</th>
                <th style="width: 200px">Bemerkung</th>
                <th style="width: 10%"></th> <!-- actions -->
            </tr>
        </thead>

        <tbody class="table-content">
            {% for item in page_obj %}
            <tr data-item-id="{{ item.id }}" class="item-row">
                <td class="text-center"><input type="radio" name="item" data-item-id="{{ item.id }}" onclick="updateSelectedItem(this)"></td>

                <td class="text-center item-id">{{ item.id }}</td>
                <td class="item-supplier">{{ item.delivery.supplier.name }}</td>
                <td>{{ item.delivery.delivery_date|date:"d.m.Y" }}</td>
                <td class="text-center item-delivery-id">{{ item.delivery_id }}</td>
                <td class="item-container">{{ item|getattr:"get_delivery_type_display" }}</td>
                <td class="item-content">{{ item.device }}</td>
                <td class="item-weight">{{ item.weight }} </td>
                <td class="item-status">{{ item|getattr:"get_status_display" }}</td>
                <td class="note-column" title="{{ item.note }}">{{ item.note }}</td>
                <td class="suppler-icons">
                    <a href="#" title="Lieferung ansehen">
                        <img src="{% static 'icons/detail-icon.svg' %}">   
                    </a>
                    <a href="#" title="Bearbeiten"> 
                        <img src="{% static 'icons/update-icon.svg' %}">
                    </a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% paginate page_obj %}
</div>

<div class="unload_cargo">
    <table class="unload-unit">
        <caption><p>Ausgew√§hlte Liefereinheit</p></caption>
        <thead>
            <tr class="table-content-title">
                <th style="width: 5%">ID</th>
                <th style="width: 40%">Lieferant</th>
                <th style="width: 15%">Beh√§lter</th>
                <th style="width: 15%">Inhalt</th>
                <th style="width: 15%">Gewicht</th>
            </tr>
        </thead>

        <tbody class="table-content">
            <tr style="height: 50px;">
                <td id="selected-id"></td>
                <td id="selected-supplier"></td>
                <td id="selected-container"></td>
                <td id="selected-content"></td>
                <td id="selected-weight"></td>
            </tr>
        </tbody>
    </table>

    <div class="row-counter">
        <p>
            <span>ü°Ü</span>
            <input type="number" id="row-counter" value="5" min="1" max="30" onchange="unload()"> 
            <span>ü°Ü</span>
        </p>
    </div>
    
    <table class="table-box">
        <caption><p>Ausleerung</p></caption>
        <thead>
            <tr class="table-content-title">
                <th style="width: 3.5%">&#8470;</th>
                <th style="width: 20%">Beh√§lter</th>
                <th style="width: 6%">Inhalt</th>
                <th style="width: 3.5%">Gewicht</th>
                <th style="width: 10%">Beh√§lter</th>
                <th style="width: 200px">Bemerkung</th>
                <th style="width: 10%"></th> <!-- actions -->
            </tr>
        </thead>
        <tbody class="table-content row-height" id="table-body">
            <!-- JavaScript -->
        </tbody>
    </table>
    
    <script>
        function unload() {
            var rowCount = document.getElementById('row-counter').value;
            var tbody = document.getElementById('table-body');
            
            tbody.innerHTML = '';
            
            for (var i = 0; i < rowCount; i++) {
                var row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${i + 1}</td>
                    <td>qwer</td>
                    <td>qwer</td>
                    <td>qwer</td>
                    <td>qwer</td>
                    <td>qwer</td>
                    <td>qwer</td>
                `;
                
                tbody.appendChild(row);
            }
        }

        unload();
    </script>

<script>
    function updateSelectedItem(radioButton) {

        var itemId = radioButton.getAttribute('data-item-id');
        var selectedRow = document.querySelector(`tr[data-item-id="${itemId}"]`);

        var id = selectedRow.querySelector('.item-id').textContent;
        var supplier = selectedRow.querySelector('.item-supplier').textContent;
        var container = selectedRow.querySelector('.item-container').textContent;
        var content = selectedRow.querySelector('.item-content').textContent;
        var weight = selectedRow.querySelector('.item-weight').textContent;

        document.getElementById('selected-id').textContent = id;
        document.getElementById('selected-supplier').textContent = supplier;
        document.getElementById('selected-container').textContent = container;
        document.getElementById('selected-content').textContent = content;
        document.getElementById('selected-weight').textContent = weight;
    }
</script>

    
</div>

{% endblock %}
